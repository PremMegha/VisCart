{% extends "base.html" %}

{% block content %}

<h1>Tenants</h1>

<table class="tenant-table">
    <thead>
        <tr>
            <th>Name</th>
            <th>Schema</th>
            <th>Domain</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        {% for tenant in tenants %}
        <tr>
            <td>{{ tenant.name }}</td>
            <td>{{ tenant.schema_name }}</td>
            <td>{{ tenant.primary_domain }}</td>
            <td>
                <!-- Edit tenant -->
                <a href="?edit={{ tenant.id }}" class="btn secondary">Edit</a>

                <!-- Go to tenant Telegram settings -->
                <a href="http://{{ tenant.primary_domain }}:8000/telegram/settings/"
                   class="btn">
                    Telegram
                </a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4">No tenants found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<div class="form-card">
    <h2>
        {% if edit_tenant %}
            Edit Tenant
        {% else %}
            Add Tenant
        {% endif %}
    </h2>

    <form method="post">
        {% csrf_token %}

        <p>
            <label>Name</label>
            <input
                type="text"
                name="name"
                value="{{ initial_name }}"
                required
            >
        </p>

        <p>
            <label>Schema Name</label>
            {% if edit_tenant %}
                <input
                    type="text"
                    name="schema_name"
                    value="{{ initial_schema }}"
                    disabled
                >
                <small style="color:#9ca3af;">
                    Schema name cannot be changed after creation
                </small>
            {% else %}
                <input
                    type="text"
                    name="schema_name"
                    value="{{ initial_schema }}"
                    placeholder="tenant1"
                    required
                >
            {% endif %}
        </p>

        <p>
            <label>Domain</label>
            <input
                type="text"
                name="domain"
                value="{{ initial_domain }}"
                placeholder="tenant1.localhost"
                required
            >
            <small style="color:#9ca3af;">
                Example: tenant1.localhost
            </small>
        </p>

        <button type="submit" class="btn">
            {% if edit_tenant %}Update{% else %}Save{% endif %}
        </button>
    </form>
</div>

{% endblock %}
